
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Exercise 4 (Training with Bayes Optimization) &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js?v=afe5de03"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'exo4_training_bs';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Exercise 4 (Training without Bayes Optimization)" href="exo4_training_gs.html" />
    <link rel="prev" title="Exercise 4 (Preprocessing)" href="exo4_preprocessing.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Wind speed prediction: a problem of the past
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="exo4_preprocessing.html">Exercise 4 (Preprocessing)</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Exercise 4 (Training with Bayes Optimization)</a></li>
<li class="toctree-l1"><a class="reference internal" href="exo4_training_gs.html">Exercise 4 (Training without Bayes Optimization)</a></li>
<li class="toctree-l1"><a class="reference internal" href="new_model.html">New Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="preprocessing.html">Exercise 4 (Preprocessing)</a></li>
<li class="toctree-l1"><a class="reference internal" href="training.html">Training</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fexo4_training_bs.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/exo4_training_bs.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Exercise 4 (Training with Bayes Optimization)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hyperparametrization">Hyperparametrization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#training">Training</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#results">Results</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="exercise-4-training-with-bayes-optimization">
<h1>Exercise 4 (Training with Bayes Optimization)<a class="headerlink" href="#exercise-4-training-with-bayes-optimization" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearnex</span> <span class="kn">import</span> <span class="n">patch_sklearn</span>
<span class="n">patch_sklearn</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Intel(R) Extension for Scikit-learn* enabled (https://github.com/intel/scikit-learn-intelex)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="n">dfWind</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/data_wind_preprocessed1.csv&#39;</span><span class="p">)</span>
<span class="n">dfWind</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Wind direction (gr)</th>
      <th>Wind gust max (m/s)</th>
      <th>Relative humidity min</th>
      <th>Precipitation (m)</th>
      <th>Wind speed (m/s)</th>
      <th>Date</th>
      <th>Hour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.809017</td>
      <td>3.8</td>
      <td>0.60</td>
      <td>0.0</td>
      <td>1.8</td>
      <td>2000-01-01 12:00:00</td>
      <td>12</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.965926</td>
      <td>4.7</td>
      <td>0.55</td>
      <td>0.0</td>
      <td>2.7</td>
      <td>2000-01-01 13:00:00</td>
      <td>13</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.891007</td>
      <td>4.9</td>
      <td>0.50</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>2000-01-01 14:00:00</td>
      <td>14</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.848048</td>
      <td>5.8</td>
      <td>0.44</td>
      <td>0.0</td>
      <td>2.5</td>
      <td>2000-01-01 15:00:00</td>
      <td>15</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.224951</td>
      <td>5.8</td>
      <td>0.43</td>
      <td>0.0</td>
      <td>2.4</td>
      <td>2000-01-01 16:00:00</td>
      <td>16</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfWind</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(90276, 7)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span><span class="p">,</span> <span class="n">Lasso</span><span class="p">,</span> <span class="n">Ridge</span><span class="p">,</span> <span class="n">BayesianRidge</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span><span class="p">,</span> <span class="n">GradientBoostingRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span><span class="p">,</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVR</span>
<span class="kn">from</span> <span class="nn">skopt.space</span> <span class="kn">import</span> <span class="n">Real</span><span class="p">,</span> <span class="n">Categorical</span><span class="p">,</span> <span class="n">Integer</span>

<span class="n">n_col</span> <span class="o">=</span> <span class="n">dfWind</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">models_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;SVR&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="n">SVR</span><span class="p">(),</span>
        <span class="s1">&#39;scalers&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;scaler&#39;</span><span class="p">:</span> <span class="n">Categorical</span><span class="p">([</span><span class="n">MinMaxScaler</span><span class="p">(),</span> <span class="n">StandardScaler</span><span class="p">()])</span>
        <span class="p">},</span>
        <span class="s1">&#39;grid&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;model__C&#39;</span><span class="p">:</span> <span class="n">Real</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">,</span> <span class="mi">10000</span><span class="p">),</span>
            <span class="s1">&#39;model__epsilon&#39;</span><span class="p">:</span> <span class="n">Real</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">,</span> <span class="mi">10000</span><span class="p">),</span>
        <span class="p">},</span>
        <span class="s1">&#39;best_params&#39;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s1">&#39;n_days&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span>
    <span class="p">},</span>

    <span class="s1">&#39;Linear Regression&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="n">LinearRegression</span><span class="p">(),</span>
        <span class="s1">&#39;scalers&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;scaler&#39;</span><span class="p">:</span> <span class="n">Categorical</span><span class="p">([</span><span class="kc">None</span><span class="p">,</span> <span class="n">MinMaxScaler</span><span class="p">(),</span> <span class="n">StandardScaler</span><span class="p">()])</span>
        <span class="p">},</span>
        <span class="s1">&#39;grid&#39;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s1">&#39;best_params&#39;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s1">&#39;n_days&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">365</span><span class="p">]</span>
    <span class="p">},</span>

    <span class="s1">&#39;Bayesian Ridge&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="n">BayesianRidge</span><span class="p">(),</span>
        <span class="s1">&#39;scalers&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;scaler&#39;</span><span class="p">:</span> <span class="n">Categorical</span><span class="p">([</span><span class="kc">None</span><span class="p">,</span> <span class="n">MinMaxScaler</span><span class="p">(),</span> <span class="n">StandardScaler</span><span class="p">()])</span>
        <span class="p">},</span>
        <span class="s1">&#39;grid&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;model__alpha_1&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.000001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">),</span>
            <span class="s1">&#39;model__alpha_2&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.000001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">),</span>
            <span class="s1">&#39;model__lambda_1&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.000001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">),</span>
            <span class="s1">&#39;model__lambda_2&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.000001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">),</span>
        <span class="p">},</span>
        <span class="s1">&#39;best_params&#39;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s1">&#39;n_days&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">365</span><span class="p">]</span>
    <span class="p">},</span>

    <span class="s1">&#39;Decision Tree&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="n">DecisionTreeRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">),</span>
        <span class="s1">&#39;scalers&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;scaler&#39;</span><span class="p">:</span> <span class="n">Categorical</span><span class="p">([</span><span class="kc">None</span><span class="p">])</span>
        <span class="p">},</span>
        <span class="s1">&#39;grid&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;model__max_depth&#39;</span><span class="p">:</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_col</span><span class="p">),</span>
        <span class="p">},</span>
        <span class="s1">&#39;best_params&#39;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s1">&#39;n_days&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">365</span><span class="p">]</span>
    <span class="p">},</span>

    <span class="s1">&#39;Random Forest&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">),</span>
        <span class="s1">&#39;scalers&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;scaler&#39;</span><span class="p">:</span> <span class="n">Categorical</span><span class="p">([</span><span class="kc">None</span><span class="p">])</span>
        <span class="p">},</span>
        <span class="s1">&#39;grid&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;model__max_depth&#39;</span><span class="p">:</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_col</span><span class="p">),</span>
            <span class="s1">&#39;model__n_estimators&#39;</span><span class="p">:</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="s1">&#39;best_params&#39;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s1">&#39;n_days&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">365</span><span class="p">]</span>
    <span class="p">},</span>

    <span class="s1">&#39;Gradient Boosting&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="n">GradientBoostingRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">),</span>
        <span class="s1">&#39;scalers&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;scaler&#39;</span><span class="p">:</span> <span class="n">Categorical</span><span class="p">([</span><span class="kc">None</span><span class="p">])</span>
        <span class="p">},</span>
        <span class="s1">&#39;grid&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;model__max_depth&#39;</span><span class="p">:</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_col</span><span class="p">),</span>
            <span class="s1">&#39;model__n_estimators&#39;</span><span class="p">:</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span>            
        <span class="p">},</span>
        <span class="s1">&#39;best_params&#39;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s1">&#39;n_days&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">365</span><span class="p">]</span>
    <span class="p">},</span>

    <span class="s1">&#39;K-NN&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">),</span>
        <span class="s1">&#39;scalers&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;scaler&#39;</span><span class="p">:</span> <span class="n">Categorical</span><span class="p">([</span><span class="kc">None</span><span class="p">,</span> <span class="n">MinMaxScaler</span><span class="p">(),</span> <span class="n">StandardScaler</span><span class="p">()])</span>
        <span class="p">},</span>
        <span class="s1">&#39;grid&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;model__n_neighbors&#39;</span><span class="p">:</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
        <span class="p">},</span>
        <span class="s1">&#39;best_params&#39;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s1">&#39;n_days&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">365</span><span class="p">]</span>
    <span class="p">},</span>

    <span class="s1">&#39;Ridge&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">),</span>
        <span class="s1">&#39;scalers&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;scaler&#39;</span><span class="p">:</span> <span class="n">Categorical</span><span class="p">([</span><span class="kc">None</span><span class="p">,</span> <span class="n">MinMaxScaler</span><span class="p">(),</span> <span class="n">StandardScaler</span><span class="p">()])</span>
        <span class="p">},</span>
        <span class="s1">&#39;grid&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;model__alpha&#39;</span><span class="p">:</span> <span class="n">Real</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="s1">&#39;best_params&#39;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s1">&#39;n_days&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">365</span><span class="p">]</span>
    <span class="p">},</span>

    <span class="s1">&#39;Lasso&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">),</span>
        <span class="s1">&#39;scalers&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;scaler&#39;</span><span class="p">:</span> <span class="n">Categorical</span><span class="p">([</span><span class="kc">None</span><span class="p">,</span> <span class="n">MinMaxScaler</span><span class="p">(),</span> <span class="n">StandardScaler</span><span class="p">()])</span>
        <span class="p">},</span>
        <span class="s1">&#39;grid&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;model__alpha&#39;</span><span class="p">:</span> <span class="n">Real</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="s1">&#39;best_params&#39;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s1">&#39;n_days&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">365</span><span class="p">]</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">name</span><span class="p">:{</span>
            <span class="n">numDays</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;pred&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;test&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;cpu_time&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;MAPEs&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;R2s&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;RMSEs&#39;</span><span class="p">:</span> <span class="p">[]</span>
            <span class="p">}</span> <span class="k">for</span> <span class="n">numDays</span> <span class="ow">in</span> <span class="n">models_dict</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;n_days&#39;</span><span class="p">]</span>
        <span class="p">}</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">models_dict</span>
<span class="p">}</span>

<span class="nb">print</span><span class="p">(</span><span class="n">results_dict</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;SVR&#39;: {1: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 3: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 7: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 14: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 21: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 30: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}}, &#39;Linear Regression&#39;: {1: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 3: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 7: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 14: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 21: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 30: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 60: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 90: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 180: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 365: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}}, &#39;Bayesian Ridge&#39;: {1: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 3: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 7: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 14: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 21: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 30: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 60: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 90: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 180: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 365: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}}, &#39;Decision Tree&#39;: {1: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 3: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 7: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 14: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 21: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 30: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 60: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 90: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 180: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 365: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}}, &#39;Random Forest&#39;: {1: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 3: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 7: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 14: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 21: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 30: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 60: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 90: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 180: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 365: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}}, &#39;Gradient Boosting&#39;: {1: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 3: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 7: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 14: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 21: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 30: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 60: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 90: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 180: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 365: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}}, &#39;K-NN&#39;: {1: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 3: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 7: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 14: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 21: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 30: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 60: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 90: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 180: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 365: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}}, &#39;Ridge&#39;: {1: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 3: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 7: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 14: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 21: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 30: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 60: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 90: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 180: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 365: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}}, &#39;Lasso&#39;: {1: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 3: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 7: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 14: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 21: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 30: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 60: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 90: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 180: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}, 365: {&#39;model&#39;: None, &#39;pred&#39;: [], &#39;test&#39;: [], &#39;cpu_time&#39;: None, &#39;MAPEs&#39;: [], &#39;R2s&#39;: [], &#39;RMSEs&#39;: []}}}
</pre></div>
</div>
</div>
</div>
<section id="hyperparametrization">
<h2>Hyperparametrization<a class="headerlink" href="#hyperparametrization" title="Link to this heading">#</a></h2>
<p>We find the best parameters only on the first set to avoid a too big data lake</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">skopt</span> <span class="kn">import</span> <span class="n">BayesSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pickle</span>

<span class="n">path_tuning</span> <span class="o">=</span> <span class="s1">&#39;../pickle/wind/tuning_bs.pkl&#39;</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path_tuning</span><span class="p">):</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">dfWind</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Wind speed (m/s)&#39;</span><span class="p">,</span> <span class="s1">&#39;Date&#39;</span><span class="p">])</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">dfWind</span><span class="p">[</span><span class="s1">&#39;Wind speed (m/s)&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">models_dict</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tuning </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
        <span class="n">model_dict</span> <span class="o">=</span> <span class="n">models_dict</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
            <span class="o">**</span><span class="n">model_dict</span><span class="p">[</span><span class="s1">&#39;scalers&#39;</span><span class="p">],</span>
            <span class="o">**</span><span class="n">model_dict</span><span class="p">[</span><span class="s1">&#39;grid&#39;</span><span class="p">]</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="n">numDays</span> <span class="ow">in</span> <span class="n">model_dict</span><span class="p">[</span><span class="s1">&#39;n_days&#39;</span><span class="p">]:</span>
            <span class="n">X_train</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">numDays</span><span class="o">*</span><span class="mi">24</span><span class="p">]</span>
            <span class="n">y_train</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">numDays</span><span class="o">*</span><span class="mi">24</span><span class="p">]</span>
            <span class="n">steps</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                <span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">model_dict</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]))</span>
            <span class="p">]</span>
            <span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span>
            <span class="n">search_cv</span> <span class="o">=</span> <span class="n">BayesSearchCV</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">search_spaces</span><span class="o">=</span><span class="n">param_grid</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;r2&#39;</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
            <span class="n">search_cv</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
            <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
            <span class="n">results_dict</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="n">numDays</span><span class="p">][</span><span class="s1">&#39;model&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">search_cv</span><span class="o">.</span><span class="n">best_estimator_</span>
            <span class="n">model_dict</span><span class="p">[</span><span class="s1">&#39;best_params&#39;</span><span class="p">][</span><span class="n">numDays</span><span class="p">]</span> <span class="o">=</span> <span class="n">search_cv</span><span class="o">.</span><span class="n">best_params_</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">numDays</span><span class="si">}</span><span class="s2"> days =&gt; </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">s =&gt; </span><span class="si">{</span><span class="n">search_cv</span><span class="o">.</span><span class="n">best_params_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_tuning</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">results_dict</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_tuning</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">results_dict</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">models_dict</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Best params for </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: &quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">numDays</span> <span class="ow">in</span> <span class="n">models_dict</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;n_days&#39;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">numDays</span><span class="si">}</span><span class="s2"> days =&gt; </span><span class="si">{</span><span class="n">results_dict</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="n">numDays</span><span class="p">][</span><span class="s1">&#39;model&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">named_steps</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Best params for SVR: 
1 days =&gt; SVR(C=4101.0396475227435, epsilon=7277.257459000677)
3 days =&gt; SVR(C=8373.883571794007, epsilon=8833.152785477094)
7 days =&gt; SVR(C=4101.0396475227435, epsilon=7277.257459000677)
14 days =&gt; SVR(C=2687.2812625982306, epsilon=2.065284656708209)
21 days =&gt; SVR(C=4101.0396475227435, epsilon=7277.257459000677)
30 days =&gt; SVR(C=8373.883571794007, epsilon=8833.152785477094)

Best params for Linear Regression: 
1 days =&gt; LinearRegression()
3 days =&gt; LinearRegression()
7 days =&gt; LinearRegression()
14 days =&gt; LinearRegression()
21 days =&gt; LinearRegression()
30 days =&gt; LinearRegression()
60 days =&gt; LinearRegression()
90 days =&gt; LinearRegression()
180 days =&gt; LinearRegression()
365 days =&gt; LinearRegression()

Best params for Bayesian Ridge: 
1 days =&gt; BayesianRidge(alpha_1=0.01, lambda_2=0.01)
3 days =&gt; BayesianRidge()
7 days =&gt; BayesianRidge(alpha_1=0.00974346811709061, alpha_2=0.0073784830242188985,
              lambda_1=0.009839271104846514, lambda_2=2.343150659302743e-05)
14 days =&gt; BayesianRidge(alpha_1=0.009743460324799277, alpha_2=0.007378475875614294,
              lambda_1=0.009839247097491627, lambda_2=2.3683592045501075e-05)
21 days =&gt; BayesianRidge(alpha_1=0.009992449765050569, alpha_2=0.0006158312611348648,
              lambda_1=0.00048556711397561736, lambda_2=0.009973237297327124)
30 days =&gt; BayesianRidge(alpha_1=0.009992449765050569, alpha_2=0.0006158312611348648,
              lambda_1=0.00048556711397561736, lambda_2=0.009973237297327124)
60 days =&gt; BayesianRidge(alpha_1=0.009992449765050569, alpha_2=0.0006158312611348648,
              lambda_1=0.00048556711397561736, lambda_2=0.009973237297327124)
90 days =&gt; BayesianRidge(alpha_1=0.009252503017164676, alpha_2=0.007323683925920016,
              lambda_1=0.009959053410975544, lambda_2=0.00993984668975188)
180 days =&gt; BayesianRidge(alpha_1=0.007039822192143179, alpha_2=0.0026753515950191245,
              lambda_1=0.008843633285849486, lambda_2=0.0018800384170421186)
365 days =&gt; BayesianRidge(alpha_1=0.004101629484574286, alpha_2=0.007277529706030074,
              lambda_1=0.009328747120479491, lambda_2=0.0031586801352770006)

Best params for Decision Tree: 
1 days =&gt; DecisionTreeRegressor(max_depth=3, random_state=42)
3 days =&gt; DecisionTreeRegressor(max_depth=3, random_state=42)
7 days =&gt; DecisionTreeRegressor(max_depth=3, random_state=42)
14 days =&gt; DecisionTreeRegressor(max_depth=4, random_state=42)
21 days =&gt; DecisionTreeRegressor(max_depth=3, random_state=42)
30 days =&gt; DecisionTreeRegressor(max_depth=4, random_state=42)
60 days =&gt; DecisionTreeRegressor(max_depth=4, random_state=42)
90 days =&gt; DecisionTreeRegressor(max_depth=6, random_state=42)
180 days =&gt; DecisionTreeRegressor(max_depth=6, random_state=42)
365 days =&gt; DecisionTreeRegressor(max_depth=6, random_state=42)

Best params for Random Forest: 
1 days =&gt; RandomForestRegressor(max_depth=7, n_estimators=200, random_state=42)
3 days =&gt; RandomForestRegressor(max_depth=4, n_estimators=200, random_state=42)
7 days =&gt; RandomForestRegressor(max_depth=7, n_estimators=53, random_state=42)
14 days =&gt; RandomForestRegressor(max_depth=5, n_estimators=88, random_state=42)
21 days =&gt; RandomForestRegressor(max_depth=3, n_estimators=200, random_state=42)
30 days =&gt; RandomForestRegressor(max_depth=4, n_estimators=10, random_state=42)
60 days =&gt; RandomForestRegressor(max_depth=7, n_estimators=159, random_state=42)
90 days =&gt; RandomForestRegressor(max_depth=6, n_estimators=10, random_state=42)
180 days =&gt; RandomForestRegressor(max_depth=7, n_estimators=200, random_state=42)
365 days =&gt; RandomForestRegressor(max_depth=7, n_estimators=200, random_state=42)

Best params for Gradient Boosting: 
1 days =&gt; GradientBoostingRegressor(max_depth=2, n_estimators=164, random_state=42)
3 days =&gt; GradientBoostingRegressor(max_depth=1, n_estimators=83, random_state=42)
7 days =&gt; GradientBoostingRegressor(max_depth=1, n_estimators=117, random_state=42)
14 days =&gt; GradientBoostingRegressor(max_depth=1, n_estimators=130, random_state=42)
21 days =&gt; GradientBoostingRegressor(max_depth=1, n_estimators=133, random_state=42)
30 days =&gt; GradientBoostingRegressor(max_depth=2, n_estimators=124, random_state=42)
60 days =&gt; GradientBoostingRegressor(n_estimators=79, random_state=42)
90 days =&gt; GradientBoostingRegressor(max_depth=2, n_estimators=175, random_state=42)
180 days =&gt; GradientBoostingRegressor(n_estimators=99, random_state=42)
365 days =&gt; GradientBoostingRegressor(max_depth=4, n_estimators=66, random_state=42)

Best params for K-NN: 
1 days =&gt; KNeighborsRegressor(n_jobs=-1, n_neighbors=1)
3 days =&gt; KNeighborsRegressor(n_jobs=-1, n_neighbors=7)
7 days =&gt; KNeighborsRegressor(n_jobs=-1)
14 days =&gt; KNeighborsRegressor(n_jobs=-1, n_neighbors=17)
21 days =&gt; KNeighborsRegressor(n_jobs=-1, n_neighbors=7)
30 days =&gt; KNeighborsRegressor(n_jobs=-1, n_neighbors=7)
60 days =&gt; KNeighborsRegressor(n_jobs=-1, n_neighbors=16)
90 days =&gt; KNeighborsRegressor(n_jobs=-1, n_neighbors=16)
180 days =&gt; KNeighborsRegressor(n_jobs=-1, n_neighbors=18)
365 days =&gt; KNeighborsRegressor(n_jobs=-1, n_neighbors=20)

Best params for Ridge: 
1 days =&gt; Ridge(alpha=0.0001, random_state=42)
3 days =&gt; Ridge(alpha=0.0001, random_state=42)
7 days =&gt; Ridge(alpha=0.0001, random_state=42)
14 days =&gt; Ridge(alpha=0.0001, random_state=42)
21 days =&gt; Ridge(alpha=0.0001, random_state=42)
30 days =&gt; Ridge(alpha=0.0001, random_state=42)
60 days =&gt; Ridge(alpha=0.0001, random_state=42)
90 days =&gt; Ridge(alpha=0.0001, random_state=42)
180 days =&gt; Ridge(alpha=0.0001, random_state=42)
365 days =&gt; Ridge(alpha=0.0001, random_state=42)

Best params for Lasso: 
1 days =&gt; Lasso(alpha=0.0001, random_state=42)
3 days =&gt; Lasso(alpha=0.0001, random_state=42)
7 days =&gt; Lasso(alpha=0.0001, random_state=42)
14 days =&gt; Lasso(alpha=0.0001, random_state=42)
21 days =&gt; Lasso(alpha=0.0001, random_state=42)
30 days =&gt; Lasso(alpha=0.0001, random_state=42)
60 days =&gt; Lasso(alpha=0.0001, random_state=42)
90 days =&gt; Lasso(alpha=0.0001, random_state=42)
180 days =&gt; Lasso(alpha=0.0001, random_state=42)
365 days =&gt; Lasso(alpha=0.0001, random_state=42)
</pre></div>
</div>
</div>
</div>
</section>
<section id="training">
<h2>Training<a class="headerlink" href="#training" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="n">model_evaluation_lr</span>


<span class="n">path_results</span> <span class="o">=</span> <span class="s1">&#39;../pickle/wind/results_bs.pkl&#39;</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path_results</span><span class="p">):</span>
    <span class="n">dict_pred</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">dfWind</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Wind speed (m/s)&#39;</span><span class="p">,</span> <span class="s1">&#39;Date&#39;</span><span class="p">])</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">dfWind</span><span class="p">[</span><span class="s1">&#39;Wind speed (m/s)&#39;</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">models_dict</span><span class="p">):</span>
        <span class="n">model_dict</span> <span class="o">=</span> <span class="n">models_dict</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Training </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">numDays</span> <span class="ow">in</span> <span class="n">model_dict</span><span class="p">[</span><span class="s1">&#39;n_days&#39;</span><span class="p">]:</span>
            <span class="n">best_params_cleaned</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;model__&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">):</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">model_dict</span><span class="p">[</span><span class="s1">&#39;best_params&#39;</span><span class="p">][</span><span class="n">numDays</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;model__&#39;</span><span class="p">)}</span>
            <span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">model_dict</span><span class="p">[</span><span class="s1">&#39;best_params&#39;</span><span class="p">][</span><span class="n">numDays</span><span class="p">][</span><span class="s1">&#39;scaler&#39;</span><span class="p">]),</span>
                    <span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">model_dict</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="o">**</span><span class="n">best_params_cleaned</span><span class="p">)),</span>
                <span class="p">]</span>
            <span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">numDays</span><span class="si">}</span><span class="s1"> days&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dfWind</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">numDays</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">24</span><span class="p">,</span> <span class="mi">24</span><span class="p">):</span>
                <span class="n">X_train</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">:</span><span class="n">j</span><span class="o">+</span><span class="n">numDays</span><span class="o">*</span><span class="mi">24</span><span class="p">]</span>
                <span class="n">y_train</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">:</span><span class="n">j</span><span class="o">+</span><span class="n">numDays</span><span class="o">*</span><span class="mi">24</span><span class="p">]</span>
                <span class="n">X_valid</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="n">numDays</span><span class="o">*</span><span class="mi">24</span><span class="p">:</span><span class="n">j</span><span class="o">+</span><span class="p">((</span><span class="n">numDays</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">24</span><span class="p">)]</span>
                <span class="n">y_valid</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="n">numDays</span><span class="o">*</span><span class="mi">24</span><span class="p">:</span><span class="n">j</span><span class="o">+</span><span class="p">((</span><span class="n">numDays</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">24</span><span class="p">)]</span>
                
                <span class="n">pipeline</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
                <span class="n">y_pred</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_valid</span><span class="p">)</span>
                <span class="n">eval_lr</span> <span class="o">=</span> <span class="n">model_evaluation_lr</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_valid</span><span class="p">)</span>

                <span class="n">results_numDays</span> <span class="o">=</span> <span class="n">results_dict</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="n">numDays</span><span class="p">]</span>
                <span class="n">results_numDays</span><span class="p">[</span><span class="s1">&#39;pred&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="n">results_numDays</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">y_valid</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="n">results_numDays</span><span class="p">[</span><span class="s1">&#39;MAPEs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">eval_lr</span><span class="p">[</span><span class="s1">&#39;mape&#39;</span><span class="p">])</span>
                <span class="n">results_numDays</span><span class="p">[</span><span class="s1">&#39;R2s&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">eval_lr</span><span class="p">[</span><span class="s1">&#39;r2&#39;</span><span class="p">])</span>
                <span class="n">results_numDays</span><span class="p">[</span><span class="s1">&#39;RMSEs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">eval_lr</span><span class="p">[</span><span class="s1">&#39;rmse&#39;</span><span class="p">])</span>
            <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
            <span class="n">cpu_time</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; =&gt; </span><span class="si">{</span><span class="n">cpu_time</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
            <span class="n">results_numDays</span><span class="p">[</span><span class="s1">&#39;cpu_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cpu_time</span>
        <span class="nb">print</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_results</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">results_dict</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_results</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">results_dict</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="results">
<h2>Results<a class="headerlink" href="#results" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_overall</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Model&#39;</span><span class="p">,</span> <span class="s1">&#39;CPU time&#39;</span><span class="p">,</span> <span class="s1">&#39;MAPE&#39;</span><span class="p">,</span> <span class="s1">&#39;R2&#39;</span><span class="p">,</span> <span class="s1">&#39;RMSE&#39;</span><span class="p">])</span>

<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">results_dict</span><span class="p">:</span>
    <span class="n">model_dict</span> <span class="o">=</span> <span class="n">models_dict</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">numDays</span> <span class="ow">in</span> <span class="n">model_dict</span><span class="p">[</span><span class="s1">&#39;n_days&#39;</span><span class="p">]:</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">results_dict</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="n">numDays</span><span class="p">]</span>
        <span class="nb">eval</span> <span class="o">=</span> <span class="n">model_evaluation_lr</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;pred&#39;</span><span class="p">],</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">])</span>
        <span class="n">new_row</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;Model&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">numDays</span><span class="si">}</span><span class="s2"> days)&quot;</span><span class="p">,</span>
            <span class="s1">&#39;CPU time&#39;</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;cpu_time&#39;</span><span class="p">],</span>
            <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="nb">eval</span><span class="p">[</span><span class="s1">&#39;mape&#39;</span><span class="p">],</span>
            <span class="s1">&#39;R2&#39;</span><span class="p">:</span> <span class="nb">eval</span><span class="p">[</span><span class="s1">&#39;r2&#39;</span><span class="p">],</span>
            <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="nb">eval</span><span class="p">[</span><span class="s1">&#39;rmse&#39;</span><span class="p">]</span>
        <span class="p">}</span>
        <span class="n">results_overall</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">results_overall</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">new_row</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_overall</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;R2&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results_overall</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                       Model  CPU time         MAPE      R2  RMSE
Gradient Boosting (365 days)    1168.4 2.250000e-01   0.765 0.567
    Random Forest (365 days)    4314.0 2.380000e-01   0.760 0.574
Gradient Boosting (180 days)     754.9 2.350000e-01   0.755 0.580
 Gradient Boosting (90 days)     572.1 2.430000e-01   0.754 0.583
    Random Forest (180 days)    2581.3 2.460000e-01   0.751 0.585
 Gradient Boosting (60 days)     273.4 2.390000e-01   0.747 0.587
     Random Forest (60 days)     960.6 2.450000e-01   0.746 0.592
     Random Forest (90 days)      77.6 2.044674e+10   0.742 0.596
 Gradient Boosting (30 days)     223.7 2.590000e-01   0.739 0.597
    Decision Tree (365 days)      32.1 4.199470e+11   0.739 0.602
             K-NN (365 days)      77.7 2.260000e-01   0.732 0.596
   Bayesian Ridge (365 days)      11.4 2.520000e-01   0.726 0.608
            Ridge (365 days)       7.4 2.490000e-01   0.726 0.608
             Ridge (90 days)       7.5 3.340000e-01   0.726 0.611
             Ridge (21 days)       7.5 2.990000e-01   0.726 0.614
Linear Regression (365 days)      10.1 2.510000e-01   0.726 0.608
            Lasso (365 days)      15.3 2.490000e-01   0.725 0.608
    Decision Tree (180 days)      21.2 1.613968e+12   0.721 0.625
   Bayesian Ridge (180 days)      11.0 2.970000e-01   0.720 0.615
            Lasso (180 days)      15.4 2.990000e-01   0.720 0.615
Linear Regression (180 days)      10.0 2.810000e-01   0.720 0.615
            Ridge (180 days)       7.5 2.990000e-01   0.720 0.615
             Ridge (30 days)      10.2 2.870000e-01   0.718 0.627
             Lasso (30 days)      10.6 2.790000e-01   0.718 0.625
 Linear Regression (30 days)       9.8 2.870000e-01   0.718 0.627
    Bayesian Ridge (30 days)      10.6 2.810000e-01   0.717 0.627
              Ridge (7 days)       7.5 3.240000e-01   0.717 0.632
             Lasso (21 days)      10.5 2.960000e-01   0.715 0.632
     Random Forest (30 days)      39.0 2.450000e-01   0.715 0.614
     Random Forest (14 days)     231.8 2.570000e-01   0.714 0.619
     Decision Tree (90 days)      15.2 5.105722e+12   0.714 0.642
 Linear Regression (21 days)       9.7 2.930000e-01   0.714 0.633
    Bayesian Ridge (90 days)       8.2 2.570000e-01   0.713 0.621
    Bayesian Ridge (21 days)      10.6 2.860000e-01   0.713 0.633
             K-NN (180 days)      77.9 2.320000e-01   0.713 0.609
 Gradient Boosting (21 days)     159.4 2.480000e-01   0.709 0.608
              K-NN (90 days)      76.1 2.320000e-01   0.704 0.614
             Lasso (90 days)      15.2 2.710000e-01   0.704 0.643
             Lasso (60 days)      10.6 2.640000e-01   0.701 0.650
     Decision Tree (60 days)      11.2 7.605376e+10   0.700 0.640
 Gradient Boosting (14 days)     141.8 2.530000e-01   0.700 0.618
 Linear Regression (60 days)       9.8 2.740000e-01   0.694 0.661
             Ridge (60 days)      10.2 2.740000e-01   0.694 0.661
 Linear Regression (90 days)       7.4 3.310000e-01   0.694 0.659
     Bayesian Ridge (3 days)       8.2 3.290000e-01   0.693 0.652
    Bayesian Ridge (60 days)      10.7 3.350000e-01   0.693 0.661
              K-NN (60 days)      74.9 2.320000e-01   0.692 0.618
              Ridge (3 days)       7.5 3.820000e-01   0.691 0.682
     Decision Tree (30 days)       9.6 1.498786e+12   0.686 0.659
      Random Forest (7 days)     131.6 5.498534e+10   0.685 0.653
     Random Forest (21 days)     480.0 2.420000e-01   0.683 0.631
              K-NN (30 days)      74.4 2.470000e-01   0.676 0.642
  Gradient Boosting (7 days)     114.1 2.780000e-01   0.670 0.644
     Decision Tree (14 days)       8.6 5.989575e+12   0.661 0.694
             Lasso (14 days)      10.5 3.600000e-01   0.660 0.720
 Linear Regression (14 days)       9.9 1.048000e+00   0.657 0.725
             Ridge (14 days)      10.0 6.140000e-01   0.657 0.725
    Bayesian Ridge (14 days)      10.6 3.370000e-01   0.655 0.725
              K-NN (21 days)      74.3 2.500000e-01   0.654 0.653
     Decision Tree (21 days)       8.7 1.404866e+11   0.649 0.681
      Random Forest (3 days)     366.7 2.780000e-01   0.613 0.693
      Decision Tree (7 days)       8.1 3.189150e+12   0.610 0.727
  Gradient Boosting (3 days)      76.1 4.360000e-01   0.587 0.704
      Decision Tree (3 days)       7.8 1.492121e+13   0.539 0.806
               K-NN (7 days)      78.2 1.499600e+11   0.526 0.753
              Ridge (1 days)       7.5 5.670000e-01   0.524 0.994
              K-NN (14 days)      78.8 2.650000e-01   0.518 0.705
              Lasso (7 days)      10.5 3.140000e-01   0.451 1.104
  Linear Regression (7 days)       7.3 3.240000e-01   0.447 1.113
     Bayesian Ridge (7 days)      10.5 3.100000e-01   0.445 1.105
  Gradient Boosting (1 days)     138.2 5.250000e-01   0.424 0.870
      Random Forest (1 days)     342.0 3.200000e-01   0.387 0.833
              Lasso (3 days)      10.4 4.370000e-01   0.369 1.336
  Linear Regression (3 days)       7.3 4.530000e-01   0.367 1.343
      Decision Tree (1 days)       7.7 3.759488e+13   0.359 0.975
               K-NN (3 days)      78.5 1.298270e+11   0.346 0.835
               K-NN (1 days)      74.5 8.437030e+13   0.236 1.077
              Lasso (1 days)      10.4 6.900000e-01   0.162 2.394
     Bayesian Ridge (1 days)      10.6 5.210000e-01   0.162 2.209
  Linear Regression (1 days)       7.3 8.340000e-01   0.162 2.400
               SVR (14 days)      10.5 3.150000e-01  -1.677 0.999
                SVR (1 days)      10.0 4.150000e-01  -1.743 1.312
                SVR (3 days)       9.9 4.040000e-01  -3.865 1.382
                SVR (7 days)      10.1 3.950000e-01  -7.703 1.450
               SVR (21 days)      10.2 3.950000e-01 -13.478 1.605
               SVR (30 days)      10.0 3.980000e-01 -15.271 1.667
</pre></div>
</div>
</div>
</div>
<p>Here we have the same training time for BayesSearchCV and GridSearchCV, but the results for BayesSearchCV are a bit better for Random Forest trained with 365 days.</p>
<p>We can see that Gradient Boosting and Random Forest are the best models for this dataset with the highest R2 and lowest RMSE. However, the CPU time for these models is significantly higher than the other models or with less days. For a real-time application, we should consider using a simpler model like Ridge Regression who has a good R2 and RMSE with a lower CPU time.</p>
<p>We can also notice that the performance of the models is better when we use more days to predict the wind speed. On the one hand this not expected because the wind speed is a chaotic system very dependant on the last values. On the other hand, the models have more data to learn from and can make better predictions.</p>
<p>That’s why it would be interesting to test the models with all the dataset without taking into account the days to see if the models can learn from the data.</p>
<p>Moreover, we have seen that almost every predictors have a high autocorrelation with the same hour of the previous days. We could use this information to predict the wind speed and train only with the same hours. This would be a very interesting approach to test.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">results_overall</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results_overall</span><span class="p">[</span><span class="s1">&#39;Model&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">results_overall</span><span class="p">[</span><span class="s1">&#39;Days&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results_overall</span><span class="p">[</span><span class="s1">&#39;Model&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">results_overall</span><span class="p">[[</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Days&#39;</span><span class="p">,</span> <span class="s1">&#39;R2&#39;</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">results_overall</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">results_overall</span><span class="p">[</span><span class="n">results_overall</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">name</span><span class="p">][</span><span class="s1">&#39;Days&#39;</span><span class="p">],</span>
        <span class="n">results_overall</span><span class="p">[</span><span class="n">results_overall</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">name</span><span class="p">][</span><span class="s1">&#39;R2&#39;</span><span class="p">],</span>
        <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Number of days&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;R2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;R2 depending on the number of days&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/19967ea29fab2c29482ac54de2e7855bbc4565c99e7192bb8fb132fe688fff6a.png" src="_images/19967ea29fab2c29482ac54de2e7855bbc4565c99e7192bb8fb132fe688fff6a.png" />
</div>
</div>
<p>This graph confirms that we have better results when we use more days to predict the wind speed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">axs</span> <span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">results_dict</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">numDays</span> <span class="ow">in</span> <span class="n">models_dict</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;n_days&#39;</span><span class="p">]:</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">results_dict</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="n">numDays</span><span class="p">]</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;pred&#39;</span><span class="p">]</span>
        <span class="n">y_test</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">y_test</span><span class="p">)],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">y_test</span><span class="p">)],</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">numDays</span><span class="si">}</span><span class="s2"> days)&quot;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">y_test</span><span class="p">))</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;True values&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Predicted values&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/222179714af5260bf1dbee9c8ed3446b80b0c5a01f69e4e9041a72fdf4042842.png" src="_images/222179714af5260bf1dbee9c8ed3446b80b0c5a01f69e4e9041a72fdf4042842.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">random</span> <span class="k">as</span> <span class="nn">rd</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
<span class="n">axs</span> <span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">results_dict</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">numDays</span> <span class="ow">in</span> <span class="n">models_dict</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;n_days&#39;</span><span class="p">]:</span>
        <span class="n">pred</span> <span class="o">=</span> <span class="n">results_dict</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="n">numDays</span><span class="p">][</span><span class="s1">&#39;pred&#39;</span><span class="p">]</span>
        <span class="n">test</span> <span class="o">=</span> <span class="n">results_dict</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="n">numDays</span><span class="p">][</span><span class="s1">&#39;test&#39;</span><span class="p">]</span>
        <span class="n">residuals</span> <span class="o">=</span> <span class="n">rd</span><span class="o">.</span><span class="n">sample</span><span class="p">([</span><span class="n">val_pred</span> <span class="o">-</span> <span class="n">val_test</span> <span class="k">for</span> <span class="n">val_pred</span><span class="p">,</span> <span class="n">val_test</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">test</span><span class="p">)],</span> <span class="mi">5000</span><span class="p">)</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">numDays</span><span class="si">}</span><span class="s2"> days&quot;</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;density&#39;</span><span class="p">)</span>

    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Residuals&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d3d51e30d060385ccf324bafbc164c93596ee662d6bac80ae71d936057281ab7.png" src="_images/d3d51e30d060385ccf324bafbc164c93596ee662d6bac80ae71d936057281ab7.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span><span class="p">,</span> <span class="n">shapiro</span>

<span class="n">df_gaussian_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Model&#39;</span><span class="p">,</span> <span class="s1">&#39;Mean&#39;</span><span class="p">,</span> <span class="s1">&#39;Std&#39;</span><span class="p">,</span> <span class="s1">&#39;p_value&#39;</span><span class="p">])</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">results_dict</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">numDays</span> <span class="ow">in</span> <span class="n">models_dict</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;n_days&#39;</span><span class="p">]:</span>
        <span class="n">pred</span> <span class="o">=</span> <span class="n">results_dict</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="n">numDays</span><span class="p">][</span><span class="s1">&#39;pred&#39;</span><span class="p">]</span>
        <span class="n">test</span> <span class="o">=</span> <span class="n">results_dict</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="n">numDays</span><span class="p">][</span><span class="s1">&#39;test&#39;</span><span class="p">]</span>
        <span class="n">residuals</span> <span class="o">=</span> <span class="p">[</span><span class="n">val_pred</span> <span class="o">-</span> <span class="n">val_test</span> <span class="k">for</span> <span class="n">val_pred</span><span class="p">,</span> <span class="n">val_test</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">test</span><span class="p">)]</span>
        <span class="n">mean</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">shapiro</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span>
        <span class="n">new_row</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;Model&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">numDays</span><span class="si">}</span><span class="s2"> days)&quot;</span><span class="p">,</span>
            <span class="s1">&#39;Mean&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
            <span class="s1">&#39;Std&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">std</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
            <span class="s1">&#39;p_value&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">p_value</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="n">df_gaussian_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_gaussian_test</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">new_row</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_gaussian_test</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Std&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_gaussian_test</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                       Model  Mean  Std  p_value
    Random Forest (365 days)  0.00 0.57      0.0
Gradient Boosting (365 days)  0.00 0.57      0.0
 Gradient Boosting (90 days) -0.01 0.58      0.0
    Random Forest (180 days) -0.01 0.58      0.0
Gradient Boosting (180 days) -0.01 0.58      0.0
 Gradient Boosting (60 days) -0.02 0.59      0.0
     Random Forest (60 days) -0.02 0.59      0.0
             K-NN (365 days)  0.02 0.60      0.0
    Decision Tree (365 days)  0.00 0.60      0.0
 Gradient Boosting (30 days) -0.02 0.60      0.0
     Random Forest (90 days) -0.01 0.60      0.0
              K-NN (90 days)  0.00 0.61      0.0
             Ridge (21 days) -0.02 0.61      0.0
             Ridge (90 days) -0.01 0.61      0.0
 Gradient Boosting (21 days) -0.02 0.61      0.0
            Ridge (180 days) -0.01 0.61      0.0
            Ridge (365 days)  0.01 0.61      0.0
            Lasso (180 days) -0.01 0.61      0.0
     Random Forest (30 days) -0.01 0.61      0.0
             K-NN (180 days)  0.00 0.61      0.0
   Bayesian Ridge (365 days)  0.01 0.61      0.0
            Lasso (365 days)  0.01 0.61      0.0
Linear Regression (365 days)  0.01 0.61      0.0
 Gradient Boosting (14 days) -0.02 0.62      0.0
    Bayesian Ridge (90 days) -0.01 0.62      0.0
   Bayesian Ridge (180 days) -0.01 0.62      0.0
Linear Regression (180 days) -0.01 0.62      0.0
     Random Forest (14 days) -0.02 0.62      0.0
              K-NN (60 days)  0.00 0.62      0.0
    Decision Tree (180 days) -0.01 0.62      0.0
 Linear Regression (30 days) -0.02 0.63      0.0
    Bayesian Ridge (30 days) -0.02 0.63      0.0
     Random Forest (21 days) -0.01 0.63      0.0
 Linear Regression (21 days) -0.02 0.63      0.0
             Ridge (30 days) -0.02 0.63      0.0
             Lasso (21 days) -0.02 0.63      0.0
             Lasso (30 days) -0.02 0.63      0.0
    Bayesian Ridge (21 days) -0.02 0.63      0.0
              Ridge (7 days) -0.02 0.63      0.0
     Decision Tree (60 days) -0.01 0.64      0.0
  Gradient Boosting (7 days) -0.03 0.64      0.0
              K-NN (30 days) -0.00 0.64      0.0
             Lasso (90 days) -0.02 0.64      0.0
     Decision Tree (90 days) -0.02 0.64      0.0
      Random Forest (7 days) -0.03 0.65      0.0
              K-NN (21 days) -0.00 0.65      0.0
     Bayesian Ridge (3 days) -0.04 0.65      0.0
             Lasso (60 days) -0.02 0.65      0.0
             Ridge (60 days) -0.02 0.66      0.0
 Linear Regression (60 days) -0.02 0.66      0.0
    Bayesian Ridge (60 days) -0.02 0.66      0.0
     Decision Tree (30 days) -0.01 0.66      0.0
 Linear Regression (90 days) -0.02 0.66      0.0
     Decision Tree (21 days) -0.01 0.68      0.0
              Ridge (3 days) -0.04 0.68      0.0
     Decision Tree (14 days) -0.02 0.69      0.0
      Random Forest (3 days) -0.02 0.69      0.0
  Gradient Boosting (3 days) -0.03 0.70      0.0
              K-NN (14 days) -0.02 0.71      0.0
             Lasso (14 days) -0.02 0.72      0.0
             Ridge (14 days) -0.02 0.72      0.0
    Bayesian Ridge (14 days) -0.02 0.72      0.0
 Linear Regression (14 days) -0.02 0.72      0.0
      Decision Tree (7 days) -0.02 0.73      0.0
               K-NN (7 days) -0.03 0.75      0.0
      Decision Tree (3 days) -0.03 0.81      0.0
      Random Forest (1 days) -0.00 0.83      0.0
               K-NN (3 days) -0.02 0.83      0.0
  Gradient Boosting (1 days) -0.01 0.87      0.0
               SVR (14 days)  0.26 0.96      0.0
      Decision Tree (1 days) -0.01 0.98      0.0
              Ridge (1 days) -0.06 0.99      0.0
               K-NN (1 days) -0.02 1.08      0.0
     Bayesian Ridge (7 days) -0.04 1.10      0.0
              Lasso (7 days) -0.04 1.10      0.0
  Linear Regression (7 days) -0.04 1.11      0.0
                SVR (1 days)  0.22 1.29      0.0
                SVR (3 days)  0.36 1.34      0.0
              Lasso (3 days) -0.05 1.34      0.0
  Linear Regression (3 days) -0.05 1.34      0.0
               SVR (21 days)  0.86 1.35      0.0
                SVR (7 days)  0.54 1.35      0.0
               SVR (30 days)  0.97 1.35      0.0
     Bayesian Ridge (1 days) -0.08 2.21      0.0
              Lasso (1 days) -0.08 2.39      0.0
  Linear Regression (1 days) -0.08 2.40      0.0
</pre></div>
</div>
</div>
</div>
<p>Here, we can notice that all the models have a p-value very close to 0 which means we can affirm with a very high confidence that the residuals are normally distributed which is a good sign beacause it means that the model is well fitted.</p>
<p>Once more we can affirm that the best models are Gradient Boosting and Random Forest because their residuals have the lowest standard deviation and a mean very close to 0.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span> <span class="k">as</span> <span class="nn">rd</span>
<span class="n">rd</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="n">y_test_RF_365</span> <span class="o">=</span> <span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;Random Forest&#39;</span><span class="p">][</span><span class="mi">365</span><span class="p">][</span><span class="s1">&#39;test&#39;</span><span class="p">]</span>
<span class="n">y_pred_RF_365</span> <span class="o">=</span> <span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;Random Forest&#39;</span><span class="p">][</span><span class="mi">365</span><span class="p">][</span><span class="s1">&#39;pred&#39;</span><span class="p">]</span>

<span class="n">y_test_GB_365</span> <span class="o">=</span> <span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;Gradient Boosting&#39;</span><span class="p">][</span><span class="mi">365</span><span class="p">][</span><span class="s1">&#39;test&#39;</span><span class="p">]</span>
<span class="n">y_pred_GB_365</span> <span class="o">=</span> <span class="n">results_dict</span><span class="p">[</span><span class="s1">&#39;Gradient Boosting&#39;</span><span class="p">][</span><span class="mi">365</span><span class="p">][</span><span class="s1">&#39;pred&#39;</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">idx_rd</span> <span class="o">=</span> <span class="n">rd</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_test_RF_365</span><span class="p">)</span> <span class="o">-</span> <span class="mi">24</span><span class="o">*</span><span class="mi">7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_test_RF_365</span><span class="p">[</span><span class="n">idx_rd</span><span class="p">:</span><span class="n">idx_rd</span> <span class="o">+</span> <span class="mi">24</span><span class="o">*</span><span class="mi">7</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;True values&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_pred_RF_365</span><span class="p">[</span><span class="n">idx_rd</span><span class="p">:</span><span class="n">idx_rd</span> <span class="o">+</span> <span class="mi">24</span><span class="o">*</span><span class="mi">7</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Random Forest (365 days)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_pred_GB_365</span><span class="p">[</span><span class="n">idx_rd</span><span class="p">:</span><span class="n">idx_rd</span> <span class="o">+</span> <span class="mi">24</span><span class="o">*</span><span class="mi">7</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Gradient Boosting (365 days)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (hours)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Wind speed (m/s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Wind speed prediction for 1 month&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/de845541ed9d8cedd7ed50910de48c25da848d5c24ca5c4d1707bbc9f2933e20.png" src="_images/de845541ed9d8cedd7ed50910de48c25da848d5c24ca5c4d1707bbc9f2933e20.png" />
</div>
</div>
<p>We can see that predictions follow quite well the true values even if the wind speed is quite volatile.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="exo4_preprocessing.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Exercise 4 (Preprocessing)</p>
      </div>
    </a>
    <a class="right-next"
       href="exo4_training_gs.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Exercise 4 (Training without Bayes Optimization)</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hyperparametrization">Hyperparametrization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#training">Training</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#results">Results</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>